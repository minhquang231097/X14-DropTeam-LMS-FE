import{j as e,a as _,b as A,r as m,B as g,L as b}from"./index-f27754b7.js";import{S as y,h as M}from"./index.esm-74388d2a.js";import{a as c,c as P}from"./customParseFormat-ea496d08.js";import{A as $,T as n,I as E}from"./index-fd00c37f.js";import{A as B}from"./AdminSearch-289065a3.js";import{g as L,a as q}from"./workplaceList.api-f66343e5.js";import{S as D}from"./StatusTag-8611cb74.js";import{h as K}from"./http-c5fb7bd7.js";import{u as T}from"./useQuery-2ba9aa5a.js";import{E as Y}from"./TextArea-e14d1cb1.js";import{D as G}from"./DeleteOutlined-978bf3e9.js";import{B as Q}from"./Breadcrumb-930b3c52.js";import{C as R}from"./index-54e4328c.js";import{T as z}from"./Table-53a05175.js";import{M as U}from"./index-b6514c61.js";import{n as I}from"./index-0cc4f263.js";import"./logo-with-shadow-2b5099bc.js";import"./lodash-cafbb443.js";import"./index-124c7d56.js";import"./SearchOutlined-c5d39dab.js";import"./index-11eb42a4.js";import"./utils-e1464f92.js";import"./DownOutlined-33901757.js";import"./index-0e55054a.js";import"./PlusOutlined-f79b1ed8.js";import"./index-a373ded8.js";import"./index-0da9c9cb.js";c.extend(P);const V=()=>{const d=_(),[p,v]=A(),o=p.get("page")??1,l=p.get("limit")??10,a=p.get("search")??null,j={position:["bottomRight"],current:Number(o),pageSize:Number(l),defaultCurrent:1,defaultPageSize:10,pageSizeOptions:[5,10,20],showSizeChanger:!0,showQuickJumper:!0},[x,F]=m.useState(null),[N,u]=m.useState(!1),[,S]=m.useState(null),{data:i}=T({queryKey:["workplaces",o,l],queryFn:async()=>(await L(o,l)).data}),{data:s}=T({queryKey:["workplaces",o,l,a],queryFn:async()=>(await q(o,l,a)).data});m.useEffect(()=>{i&&S(i.data),s&&S(s.data),a||d(`/admin/facilities/all?page=${o}&limit=${l}`)},[l,d,o,a,s,i]);const O=async()=>{try{await K.delete(`/workplace/${x==null?void 0:x._id}`),I.success({message:"Delete successful",description:"The workplace has been deleted successfully"})}catch(t){I.error({message:"Delete failed",description:t.message})}u(!1)},w=t=>{const{current:r,pageSize:h}=t,f=a?`&search=${a}`:"";d(`/admin/facilities/all?page=${r}&limit=${h}${f}`)},k=t=>{v({search:t})},C=[{title:e.jsx(n.Text,{style:{fontSize:"18px"},children:"Image"}),dataIndex:"image_url",width:"15%",render:()=>e.jsx(E,{src:"https://res.cloudinary.com/dar4pvqx2/image/upload/v1693931926/vitebanner_wtcoum.jpg",alt:"Facility Image"}),responsive:["lg"]},{title:e.jsx(n.Text,{style:{fontSize:"18px"},children:"Facility"}),dataIndex:"name",width:"45%",render:(t,r)=>e.jsxs(y,{direction:"vertical",children:[e.jsxs(n.Text,{strong:!0,style:{fontSize:"22px"},children:[t," (",r.workplace_code,")"]}),e.jsxs(n.Text,{children:["Created at: ",c(r.create_at).format("DD/MM/YYYY")]})]}),sorter:(t,r)=>{const h=t.create_at?c(t.create_at):c(""),f=r.create_at?c(r.create_at):c("");return h-f},defaultSortOrder:"descend"},{title:e.jsx(n.Text,{style:{fontSize:"18px"},children:"Status"}),dataIndex:"status",width:"15%",render:t=>e.jsx(D,{status:t,style:{fontSize:"14px",padding:"4px 8px"}}),filters:[{text:"ACTIVE",value:"ON"},{text:"INACTIVE",value:"OFF"},{text:"UPCOMING",value:"UPCOMING"}],onFilter:(t,{status:r})=>String(r).indexOf(String(t))===0,responsive:["md"]},{title:e.jsx(n.Text,{style:{fontSize:"18px"},children:"Action"}),width:"10%",render:t=>e.jsxs(y,{children:[e.jsx(g,{type:"primary",size:"large",onClick:()=>{d(`/admin/facilities/show/${t._id}`)},children:e.jsx(Y,{className:"text-white text-[22px]"})}),e.jsx(g,{type:"primary",size:"large",danger:!0,onClick:()=>{F(t),u(!0)},children:e.jsx(G,{className:"text-white text-[22px]"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(Q,{items:[{title:e.jsx(b,{to:"/admin",children:"Home"})},{title:"Facilities"}],style:{padding:"4px",fontSize:"16px"}}),e.jsxs(R,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n.Title,{level:3,className:"mt-0 mx-1",children:"Facility List"}),e.jsxs(y,{className:"flex",size:"middle",children:[e.jsx(B,{endpoint:"workplace",keysearch:a??"",onChangeInput:k}),e.jsx(g,{type:"primary",onClick:()=>d("/admin/facilities/create"),style:{display:"flex",alignItems:"center",height:"40px",fontSize:"16px"},children:e.jsx(M,{className:"text-[22px]"})})]})]}),i&&!a&&e.jsx(z,{rowKey:t=>t._id,columns:C,dataSource:i.data,pagination:{...j,total:i==null?void 0:i.total},onChange:w,style:{marginTop:16}}),a&&e.jsx(z,{rowKey:t=>t._id,columns:C,dataSource:s==null?void 0:s.data,pagination:{...j,total:s==null?void 0:s.total},onChange:w,style:{marginTop:16}})]}),e.jsx(U,{title:"Confirm Delete",onOk:O,okType:"danger",onCancel:()=>u(!1),getContainer:!1,open:N,children:e.jsx(n.Text,{children:"Are you sure you want to delete this facility?"})})]})},Ce=()=>e.jsx($,{content:e.jsx(V,{})});export{Ce as default};
