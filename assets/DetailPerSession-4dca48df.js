import{a as w,r as x,j as t,B as _,b as C}from"./index-192efbd6.js";import{F as I}from"./index.esm-2bc070f5.js";import{H as T,F as y}from"./Footer-f2455721.js";import{S as E}from"./SidebarTeacher-a502cef7.js";import{b as A}from"./index.esm-9d8ca0d7.js";import{T as P}from"./Table-716a92a9.js";import{T as f}from"./index-7819b48b.js";import{S as D}from"./index-94760dca.js";import{I as F}from"./index-59f0cd95.js";import{m as h}from"./index-9ce30b7c.js";import{I as B}from"./index-30314ea6.js";import{h as v}from"./http-f102274f.js";import{u as k}from"./useQuery-05bba707.js";import"./TextArea-7be9bcb6.js";import"./logo-with-shadow-2b5099bc.js";import"./lodash-052e4736.js";import"./index-d2bb848c.js";import"./index-f92a1eda.js";import"./SearchOutlined-f2ed9689.js";import"./DownOutlined-ac74e25c.js";import"./utils-b4e47d6c.js";const{TextArea:O}=B,R=s=>{const o=w(),d=[{title:"No.",dataIndex:"index",width:"40px",render:(e,a,n)=>n+1},{title:"Student Name",dataIndex:"student",width:"140px",render:e=>e.fullname,onFilter:(e,{student:a})=>a&&String(a.fullname).toLowerCase().includes(String(e).toLowerCase())},{title:"Email",dataIndex:"student",width:"212px",render:e=>e.email},{title:"Phone Number",dataIndex:"student",width:"120px",render:e=>e.phone_number},{title:"Status",key:"tags",dataIndex:"status",width:"100px",render:(e,{status:a})=>t.jsx(t.Fragment,{children:a==="ACTIVE"&&t.jsx(f,{color:"green",children:a.toUpperCase()},"ACTIVE")||a==="INACTIVE"&&t.jsx(f,{color:"volcano",children:a.toUpperCase()},"INACTIVE")||t.jsx(f,{color:"geekblue",children:"unknown".toUpperCase()},"undefined")}),filters:[{text:"ACTIVE",value:"active"},{text:"INACTIVE",value:"inactive"},{text:"UNKNOWN",value:"unknown"}],onFilter:(e,{status:a})=>String(a).indexOf(String(e))===0},{title:"Attendance",render:(e,a)=>t.jsx(D,{disabled:a.disabled,defaultValue:"Select",style:{width:"100%"},options:[{value:"PRESENT",label:t.jsx("span",{className:"text-[#389E0D]",children:"Present"})},{value:"ABSENT WITH PERMISSION",label:t.jsx("span",{className:"text-[#D46B08]",children:"Absent With Permission"})},{value:"ABSENT WITHOUT PERMISSION",label:t.jsx("span",{className:"text-[#6737B5]",children:"Absent Without Permission"})},{value:"RESERVE",label:t.jsx("span",{className:"text-[#C41D7F]",children:"Reserve"})}],onChange:n=>S(n,a)})},{title:"Score",width:"80px",render:(e,a)=>t.jsx(F,{disabled:a.disabled,placeholder:"Input score ...",min:0,max:10,controls:!1,style:{width:"100%"},required:!0,onBlur:n=>p(n)})},{title:"Comment",render:(e,a)=>t.jsx(O,{disabled:a.disabled,rows:1,placeholder:"Comment here ...",onBlur:n=>l(n)})},{title:"Action",width:"60px",render:(e,a)=>t.jsx(_,{type:"link",icon:t.jsx(A,{className:"w-6 h-6 text-green-600 active:text-green-900"}),onClick:()=>{s.handleBeforeSubmit(i),m(a),h.success("Saved!")}})}];let g=[];s.data!==void 0&&(g=s.searchText?s.filteredData.data:s.data.data);const[i,r]=x.useState(),S=(e,a)=>{const n={session_id:a._id,student_id:a.student._id,status:e};r(n)};localStorage.setItem("attendanceStudent",JSON.stringify(i));const p=(e,a)=>{if(e.target.value==="")h.error("Please input Score as a Number!");else{const n={...i,score:e.target.value};r(n)}localStorage.setItem("attendanceStudent",JSON.stringify(i))},l=(e,a)=>{if(e.target.value!==""){const n={...i,comment:e.target.value};r(n),localStorage.setItem("attendanceStudent",JSON.stringify(i))}},c=(e,a,n,N)=>{const{current:u,pageSize:b}=e;s.setSearchParams(u),o(`/teacher/class-detail/session?sesson_code=${s.session_code}&class_id=${s.class_id}&page=${u}&limit=${b}`)},m=e=>{e.disabled=!0};return t.jsx(P,{pagination:{position:["bottomCenter"],defaultCurrent:1,defaultPageSize:10,pageSizeOptions:[10,20],showSizeChanger:!0,current:s.data&&s.data.page,total:s.data&&s.data.total},columns:d,dataSource:g,scroll:{y:340},bordered:!0,size:"small",style:{padding:"0 16px"},rowKey:e=>e._id,onChange:c})},V=(s,o,d)=>v.get("/user",{params:{class_id:s,page:o,limit:d}}),z=async(s,o)=>v.post("/attendance",{list:s}).then(()=>{h.success("Done!"),setTimeout(()=>{o("/teacher/classes-list?page=1&limit=10")},1200)}).catch(()=>{h.error("Error!")}),oe=()=>{const[s,o]=x.useState(""),[d,g]=x.useState([]),i=w(),[r,S]=C(),p=r.get("session_id")??"",l=r.get("session_code")??"",c=r.get("class_id")??"",m=r.get("page")??"1",e=r.get("limit")??"10",a=k({queryKey:["students",c,p,m,e],queryFn:async()=>(await V(c,m,e)).data}).data,[n,N]=x.useState([]),u=j=>{N([...n,j])},b=()=>{z(n,i)};return t.jsxs(t.Fragment,{children:[t.jsx(T,{}),t.jsxs("div",{className:"max-w-[1280px] mx-auto py-8 grid grid-cols-7 gap-4",children:[t.jsx(E,{}),t.jsxs("div",{className:"col-span-6 row-span-4 bg-white dark:bg-[#1E293B] dark:border-none rounded-lg border-[1px] border-solid border-gray-200 overflow-hidden",style:{boxShadow:"0 0 10px rgba(0,0,0,.18)",cursor:"pointer",border:"1px solid rgba(0,0,0,.1)"},children:[t.jsxs("div",{className:"p-4 flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xl text-[#F56A00] font-bold",children:l?`Session Code: ${l}`:"Session Code"}),t.jsxs("p",{className:"m-0 text-sm text-gray-500 mt-2",children:["Total students: ",t.jsx("span",{className:"text-blue-600",children:a?a.total:0})]})]}),t.jsx("div",{className:"flex flex-col items-end",children:t.jsx(_,{className:"mt-3",type:"primary",icon:t.jsx(I,{className:"w-6 h-6"}),size:"large",ghost:!0,onClick:b})})]}),t.jsx(R,{data:a,searchText:s,setSearchParams:S,session_code:l,class_id:c,filteredData:d,handleBeforeSubmit:u})]})]}),t.jsx(y,{})]})};export{oe as default};
